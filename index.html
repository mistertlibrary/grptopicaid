<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Proposal Engine</title>
    <style>
        :root {
            --bg: #1a1a2e;
            --card-bg: #16213e;
            --accent: #e94560; /* Electric Red */
            --highlight: #0f3460;
            --text: #e0e0e0;
            --neon-blue: #4cc9f0;
            --neon-purple: #7209b7;
        }

        body {
            font-family: 'Poppins', 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: var(--text);
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }

        header {
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border-bottom: 2px solid var(--accent);
            padding: 1.5rem;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        h1 {
            margin: 0;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 2px;
            background: linear-gradient(to right, var(--neon-blue), var(--neon-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 2rem;
        }

        .subtitle {
            font-size: 0.9rem;
            color: #ccc;
            margin-top: 5px;
            font-family: 'Courier New', monospace;
        }

        .container {
            max-width: 850px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        /* CARD STYLES */
        .card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            backdrop-filter: blur(5px);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            transition: transform 0.3s ease, border-color 0.3s ease;
        }

        .card:hover {
            border-color: var(--neon-blue);
        }

        h2 {
            margin-top: 0;
            color: var(--neon-blue);
            font-size: 1.5rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding-bottom: 10px;
        }

        /* PHASE 1: SLOT MACHINE */
        .slot-machine {
            display: flex;
            gap: 1.5rem;
            justify-content: center;
            margin: 2rem 0;
            flex-wrap: wrap;
        }

        .reel-container {
            flex: 1;
            min-width: 280px;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .label-neon {
            color: var(--accent);
            font-weight: bold;
            text-transform: uppercase;
            font-size: 0.8rem;
            letter-spacing: 1px;
        }

        .reel {
            background: #000;
            border: 4px solid var(--neon-purple);
            border-radius: 12px;
            height: 140px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 1rem;
            font-size: 1.4rem;
            font-weight: 700;
            color: #fff;
            text-shadow: 0 0 10px var(--neon-purple);
            box-shadow: inset 0 0 20px rgba(0,0,0,0.8);
            position: relative;
            overflow: hidden;
        }

        /* The "Glass" effect on the reel */
        .reel::after {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 50%;
            background: linear-gradient(to bottom, rgba(255,255,255,0.1), transparent);
            pointer-events: none;
        }

        /* CONTROLS & INPUTS */
        .controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
        }

        button {
            background: linear-gradient(45deg, var(--accent), #ff2e63);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 800;
            text-transform: uppercase;
            box-shadow: 0 4px 15px rgba(233, 69, 96, 0.4);
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(233, 69, 96, 0.6);
        }

        button:active { transform: translateY(1px); }

        button:disabled {
            background: #555;
            box-shadow: none;
            cursor: not-allowed;
            opacity: 0.7;
        }

        button.secondary {
            background: transparent;
            border: 2px solid var(--text);
            box-shadow: none;
        }
        button.secondary:hover { background: rgba(255,255,255,0.1); }

        /* INPUTS */
        input[type="text"], textarea, select {
            width: 100%;
            padding: 1rem;
            background: rgba(0,0,0,0.3);
            border: 2px solid #444;
            border-radius: 8px;
            color: #fff;
            font-family: inherit;
            margin-top: 5px;
            transition: border-color 0.3s;
            box-sizing: border-box;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--neon-blue);
            background: rgba(0,0,0,0.5);
        }

        .research-warning {
            background: rgba(233, 69, 96, 0.15);
            border: 1px solid var(--accent);
            color: #ffcccc;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .research-icon { font-size: 1.5rem; }

        /* ANIMATIONS */
        @keyframes blur-text {
            0% { filter: blur(0px); transform: translateY(0); opacity: 1; }
            50% { filter: blur(4px); transform: translateY(5px); opacity: 0.5; }
            100% { filter: blur(0px); transform: translateY(0); opacity: 1; }
        }
        .spinning-text { animation: blur-text 0.1s infinite; color: var(--neon-blue); }

        /* PASSPORT (Print View) */
        #passport-view {
            background: white;
            color: black;
            padding: 40px;
            border-radius: 4px;
            font-family: 'Times New Roman', serif;
            box-shadow: 0 0 30px rgba(0,0,0,0.5);
        }
        
        .pp-header {
            border-bottom: 2px solid #000;
            padding-bottom: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }

        .pp-section { margin-bottom: 20px; }
        .pp-label { 
            font-weight: bold; 
            text-transform: uppercase; 
            font-size: 0.75rem; 
            color: #666; 
            font-family: sans-serif;
            letter-spacing: 1px;
        }
        .pp-content { font-size: 1.1rem; line-height: 1.5; margin-top: 4px; }

        /* Link Buttons */
        .search-chip {
            display: inline-block;
            background: var(--neon-blue);
            color: #000;
            padding: 8px 12px;
            border-radius: 20px;
            text-decoration: none;
            font-weight: bold;
            font-size: 0.85rem;
            margin-right: 10px;
            margin-top: 10px;
            transition: transform 0.2s;
        }
        .search-chip:hover { transform: scale(1.05); background: white; }

        .hidden { display: none; }

        /* Print Override */
        @media print {
            body { background: white; color: black; }
            header, .container > .card { display: none; }
            #phase-4 { display: block !important; box-shadow: none; border: none; padding: 0; }
            #passport-view { box-shadow: none; padding: 0; }
            .controls { display: none; }
            .search-chip { display: none; }
        }
    </style>
</head>
<body>

<header>
    <h1>The Event Proposal Engine</h1>
    <div class="subtitle">Global Research Project // Landmark Discovery</div>
</header>

<div class="container">

    <div id="phase-1" class="card">
        <h2>Phase 1: Spin the Archives</h2>
        <p>Find a collision between a broad theme and a specific moment in history.</p>
        
        <div class="slot-machine">
            <div class="reel-container">
                <div class="label-neon">Umbrella Topic</div>
                <div id="reel-topic" class="reel">READY?</div>
                <select id="topic-lock" style="margin-top:10px;">
                    <option value="">(surprise me)</option>
                    <option value="Gender Roles and Equality">Gender Roles & Equality</option>
                    <option value="Cultural/Societal Pressures">Cultural/Societal Pressures</option>
                    <option value="Dehumanization">Dehumanization</option>
                    <option value="Religious Fundamentalism">Religious Fundamentalism</option>
                    <option value="Political Propaganda">Political Propaganda</option>
                    <option value="Violence as Power">Violence as Power</option>
                </select>
            </div>
            
            <div class="reel-container">
                <div class="label-neon">The Landmark</div>
                <div id="reel-event" class="reel">SPIN IT</div>
                <div style="text-align: center; font-size: 0.8rem; opacity: 0.7; margin-top: 5px;">
                    (events post-2006)
                </div>
            </div>
        </div>

        <div class="controls">
            <button id="spin-btn" onclick="spinReels()">INITIATE SPIN üîä</button>
            <button id="accept-btn" class="secondary" onclick="goToPhase2()" disabled>Lock In Selection</button>
        </div>
    </div>

    <div id="phase-2" class="card hidden">
        <h2>Phase 2: Find Your Angle</h2>
        <p style="margin-bottom: 2rem;">A "Landmark" isn't just something that happened. It's a turning point.</p>

        <div class="research-warning">
            <span class="research-icon">‚ö†Ô∏è</span>
            <div>
                <strong>Research Required:</strong> You cannot guess your way through this. Open a new tab. Find the facts.
            </div>
        </div>

        <div style="background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem; text-align: center;">
            <div class="label-neon" style="color:var(--neon-blue)">Target Event</div>
            <h3 id="display-event-name" style="margin: 5px 0 0 0; font-size: 1.4rem;"></h3>
            <div id="display-topic-name" style="opacity: 0.8; font-style: italic;"></div>
        </div>

        <div style="margin-bottom: 1.5rem;">
            <label class="label-neon">Investigator Name</label>
            <input type="text" id="student-name-input" placeholder="(your full name)">
        </div>

        <div style="margin-bottom: 1.5rem;">
            <label class="label-neon">1. Categorize It</label>
            <select id="landmarkType">
                <option value="">(choose one)</option>
                <option value="Event">Event (a specific occurrence)</option>
                <option value="Discovery">Discovery (new knowledge/tech)</option>
                <option value="Change">Change (shift in law/culture)</option>
            </select>
        </div>

        <div style="margin-bottom: 1.5rem;">
            <label class="label-neon">2. Select Your Lens (The Aspect)</label>
            <p style="font-size: 0.9rem; margin-top: 5px; opacity: 0.8;">Which part of this story are you zooming in on?</p>
            <select id="aspectType">
                <option value="">(choose one)</option>
                <option value="Human">The Human Path (Who started it? Who suffered?)</option>
                <option value="Reaction">The Reaction Path (What did the world say?)</option>
                <option value="Legacy">The Legacy Path (What laws/rules changed?)</option>
            </select>
        </div>

        <div style="margin-bottom: 1.5rem;">
            <label class="label-neon">3. The Big Question</label>
            <textarea id="aspect-question" placeholder="(ex: why did the public react so strongly to...?)"></textarea>
        </div>

        <div class="controls">
            <button class="secondary" onclick="resetTool()">Reset</button>
            <button onclick="goToPhase3()">Next: The Deep Dive</button>
        </div>
    </div>

    <div id="phase-3" class="card hidden">
        <h2>Phase 3: The Deep Dive</h2>
        <p>Use your preliminary research to build the <strong>Significance Paragraph</strong> required for your proposal.</p>

        <div class="research-warning">
            <span class="research-icon">üß†</span>
            <div>
                <strong>Don't Fake It:</strong> These boxes build your final paragraph. Use specific nouns, dates, and facts.
            </div>
        </div>

        <div style="margin-bottom: 1.5rem;">
            <label class="label-neon">1. The Hook (Who, What, Where, When?)</label>
            <textarea id="sent-1" placeholder="(start with the basics: dates, locations, key players)"></textarea>
        </div>

        <div style="margin-bottom: 1.5rem;">
            <label class="label-neon">2. The Vibe Shift (What was happening before?)</label>
            <textarea id="sent-2" placeholder="(prior to this event, the situation was...)"></textarea>
        </div>

        <div style="margin-bottom: 1.5rem;">
            <label class="label-neon">3. The Boom (Why is this a landmark?)</label>
            <textarea id="sent-3" placeholder="(this was a turning point because...)"></textarea>
        </div>

        <div style="margin-bottom: 1.5rem;">
            <label class="label-neon">4. The Connection (Tie it to the theme)</label>
            <textarea id="sent-4" placeholder="(this connects to [theme] because...)"></textarea>
        </div>

        <div style="margin-bottom: 1.5rem;">
            <label class="label-neon">5. The Aftermath (How does it affect us now?)</label>
            <textarea id="sent-5" placeholder="(ultimately, the legacy of this event is...)"></textarea>
        </div>

        <div class="controls">
            <button class="secondary" onclick="backToPhase2()">Back</button>
            <button onclick="generatePassport()">Generate Proposal</button>
        </div>
    </div>

    <div id="phase-4" class="card hidden">
        <h2>Mission Complete</h2>
        <p>Here is your structured proposal. Print it, copy it, or save it as a PDF.</p>
        
        <div id="passport-view">
            <div class="pp-header">
                <div>
                    <h2 style="margin:0; color:black; font-family:serif;">Event Proposal</h2>
                    <div style="font-size: 0.9rem;">Global Research Project</div>
                </div>
                <div><strong>Date:</strong> <span id="current-date"></span></div>
            </div>

            <div class="pp-section">
                <div class="pp-label">Investigator</div>
                <div class="pp-content" id="pp-name"></div>
            </div>

            <div class="pp-section">
                <div class="pp-label">Umbrella Topic</div>
                <div class="pp-content" id="pp-topic"></div>
            </div>

            <div class="pp-section">
                <div class="pp-label">Event Details</div>
                <div class="pp-content">
                    <span id="pp-event" style="font-weight:bold;"></span> 
                    <span style="color:#666;">(<span id="pp-date"></span>)</span>
                </div>
            </div>

            <div class="pp-section">
                <div class="pp-label">Aspect of Focus</div>
                <div class="pp-content" id="pp-aspect"></div>
                <div style="font-size: 0.85rem; margin-top: 4px; font-style:italic;">
                    Type: <span id="pp-type"></span> | Path: <span id="pp-path"></span>
                </div>
            </div>

            <div class="pp-section">
                <div class="pp-label">Significance & Context (Draft)</div>
                <div class="pp-content" id="pp-paragraph" style="text-align: justify;"></div>
            </div>
        </div>

        <div style="margin-top: 2rem; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1rem;">
            <div class="label-neon" style="color:var(--neon-blue); margin-bottom: 10px;">Verify Your Work (Academic Sources)</div>
            <div id="link-container"></div>
        </div>

        <div class="controls">
            <button onclick="window.print()">Print / Save PDF</button>
            <button class="secondary" onclick="resetTool()">Start Over</button>
        </div>
    </div>

</div>

<script>
    // --- SOUND ENGINE (Simple Web Audio API) ---
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    
    function playTone(freq, type, duration) {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = type;
        osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
        gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + duration);
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        osc.start();
        osc.stop(audioCtx.currentTime + duration);
    }

    function playSpinSound() {
        // A rapid sequence of blips
        let count = 0;
        const interval = setInterval(() => {
            playTone(200 + (Math.random() * 100), 'square', 0.05);
            count++;
            if(count > 15) clearInterval(interval);
        }, 80);
    }

    function playWinSound() {
        // A high pitched "ding" sequence
        setTimeout(() => playTone(600, 'sine', 0.3), 0);
        setTimeout(() => playTone(800, 'sine', 0.5), 150);
    }

    // --- DATA ---
    const landmarks = [
        { event: "Lilly Ledbetter Fair Pay Act", date: "Jan 2009", topic: "Gender Roles and Equality" },
        { event: "Repeal of 'Don't Ask, Don't Tell'", date: "Sept 2011", topic: "Gender Roles and Equality" },
        { event: "Assassination Attempt: Malala", date: "Oct 2012", topic: "Gender Roles and Equality" },
        { event: "US Combat Ban Lifted (Women)", date: "Jan 2013", topic: "Gender Roles and Equality" },
        { event: "Obergefell v. Hodges", date: "June 2015", topic: "Gender Roles and Equality" },
        { event: "Saudi Women Vote (First Time)", date: "Dec 2015", topic: "Gender Roles and Equality" },
        { event: "Hillary Clinton Nomination", date: "July 2016", topic: "Gender Roles and Equality" },
        { event: "Women's March on Washington", date: "Jan 2017", topic: "Gender Roles and Equality" },
        { event: "#MeToo Goes Viral", date: "Oct 2017", topic: "Gender Roles and Equality" },
        { event: "Ireland Repeals 8th Amendment", date: "May 2018", topic: "Gender Roles and Equality" },
        { event: "Saudi Women Drive (Ban Lifted)", date: "June 2018", topic: "Gender Roles and Equality" },
        { event: "Kamala Harris Inauguration", date: "Jan 2021", topic: "Gender Roles and Equality" },
        { event: "Dobbs v. Jackson (Roe Overturned)", date: "June 2022", topic: "Gender Roles and Equality" },
        { event: "Spain 'Se Acab√≥' Scandal", date: "Aug 2023", topic: "Gender Roles and Equality" },
        { event: "France: Abortion in Constitution", date: "Jan 2024", topic: "Gender Roles and Equality" },
        
        { event: "Launch of First iPhone", date: "June 2007", topic: "Cultural/Societal Pressures" },
        { event: "Launch of Airbnb", date: "Aug 2008", topic: "Cultural/Societal Pressures" },
        { event: "Launch of Instagram", date: "Oct 2010", topic: "Cultural/Societal Pressures" },
        { event: "Occupy Wall Street", date: "Sept 2011", topic: "Cultural/Societal Pressures" },
        { event: "Curiosity Rover Lands", date: "Aug 2012", topic: "Cultural/Societal Pressures" },
        { event: "DSM-5 Published", date: "May 2013", topic: "Cultural/Societal Pressures" },
        { event: "Flint Water Crisis", date: "Apr 2014", topic: "Cultural/Societal Pressures" },
        { event: "Greta Thunberg's Strike", date: "Aug 2018", topic: "Cultural/Societal Pressures" },
        { event: "First Black Hole Image", date: "Apr 2019", topic: "Cultural/Societal Pressures" },
        { event: "COVID-19 Pandemic Declared", date: "Mar 2020", topic: "Cultural/Societal Pressures" },
        { event: "Beeple NFT Sale ($69M)", date: "Mar 2021", topic: "Cultural/Societal Pressures" },
        { event: "ChatGPT Released", date: "Nov 2022", topic: "Cultural/Societal Pressures" },
        { event: "Neuralink Human Implant", date: "Jan 2024", topic: "Cultural/Societal Pressures" },
        { event: "GDPR Enacted (EU)", date: "May 2018", topic: "Cultural/Societal Pressures" },

        { event: "Shooting of Trayvon Martin", date: "Feb 2012", topic: "Dehumanization" },
        { event: "Russia 'Gay Propaganda' Law", date: "June 2013", topic: "Dehumanization" },
        { event: "Yazidi Genocide by ISIS", date: "Aug 2014", topic: "Dehumanization" },
        { event: "Photo of Alan Kurdi", date: "Sept 2015", topic: "Dehumanization" },
        { event: "Pulse Nightclub Shooting", date: "June 2016", topic: "Dehumanization" },
        { event: "Rohingya Genocide", date: "Aug 2017", topic: "Dehumanization" },
        { event: "Charlottesville 'Unite the Right'", date: "Aug 2017", topic: "Dehumanization" },
        { event: "US 'Zero Tolerance' Border Policy", date: "May 2018", topic: "Dehumanization" },
        { event: "Tree of Life Shooting", date: "Oct 2018", topic: "Dehumanization" },
        { event: "Death of George Floyd", date: "May 2020", topic: "Dehumanization" },
        { event: "Kamloops School Graves", date: "May 2021", topic: "Dehumanization" },
        { event: "Bucha Massacre", date: "Apr 2022", topic: "Dehumanization" },
        { event: "Uyghur Human Rights Act", date: "June 2020", topic: "Dehumanization" },
        { event: "Death of Alexei Navalny", date: "Feb 2024", topic: "Dehumanization" },

        { event: "Siege of Red Mosque", date: "July 2007", topic: "Religious Fundamentalism" },
        { event: "Anders Breivik Attacks", date: "July 2011", topic: "Religious Fundamentalism" },
        { event: "Timbuktu Shrines Destroyed", date: "June 2012", topic: "Religious Fundamentalism" },
        { event: "Chibok Schoolgirls Kidnapping", date: "Apr 2014", topic: "Religious Fundamentalism" },
        { event: "Modi Elected (India)", date: "May 2014", topic: "Religious Fundamentalism" },
        { event: "Charlie Hebdo Shooting", date: "Jan 2015", topic: "Religious Fundamentalism" },
        { event: "Christchurch Shootings", date: "Mar 2019", topic: "Religious Fundamentalism" },
        { event: "Taliban Retakes Kabul", date: "Aug 2021", topic: "Religious Fundamentalism" },
        { event: "Death of Mahsa Amini", date: "Sept 2022", topic: "Religious Fundamentalism" },
        { event: "Kim Davis Jailed", date: "Sept 2015", topic: "Religious Fundamentalism" },
        { event: "Pope Benedict XVI Resigns", date: "Feb 2013", topic: "Religious Fundamentalism" },
        { event: "Hagia Sophia Reconversion", date: "July 2020", topic: "Religious Fundamentalism" },

        { event: "Obama 'Hope' Poster", date: "Nov 2008", topic: "Political Propaganda" },
        { event: "Citizens United v. FEC", date: "Jan 2010", topic: "Political Propaganda" },
        { event: "Arab Spring Social Media", date: "Jan 2011", topic: "Political Propaganda" },
        { event: "Kony 2012 Viral Video", date: "Mar 2012", topic: "Political Propaganda" },
        { event: "Snowden Leaks", date: "June 2013", topic: "Political Propaganda" },
        { event: "Crimea Annexation", date: "Mar 2014", topic: "Political Propaganda" },
        { event: "Brexit Vote", date: "June 2016", topic: "Political Propaganda" },
        { event: "Russian Election Interference", date: "Nov 2016", topic: "Political Propaganda" },
        { event: "'Alternative Facts' Coined", date: "Jan 2017", topic: "Political Propaganda" },
        { event: "Cambridge Analytica Scandal", date: "Mar 2018", topic: "Political Propaganda" },
        { event: "The 'Big Lie' Emerges", date: "Nov 2020", topic: "Political Propaganda" },
        { event: "Pegasus Spyware", date: "July 2021", topic: "Political Propaganda" },
        { event: "Deepfake Political Ads", date: "Oct 2023", topic: "Political Propaganda" },
        { event: "QAnon Emergence", date: "Oct 2017", topic: "Political Propaganda" },

        { event: "Mumbai Terror Attacks", date: "Nov 2008", topic: "Violence as Power" },
        { event: "Osama bin Laden Killed", date: "May 2011", topic: "Violence as Power" },
        { event: "Syrian Civil War Begins", date: "Mar 2011", topic: "Violence as Power" },
        { event: "Sandy Hook Shooting", date: "Dec 2012", topic: "Violence as Power" },
        { event: "Euromaidan Revolution", date: "Feb 2014", topic: "Violence as Power" },
        { event: "Russian Intervention in Syria", date: "Sept 2015", topic: "Violence as Power" },
        { event: "Khashoggi Assassination", date: "Oct 2018", topic: "Violence as Power" },
        { event: "Hong Kong Protests", date: "June 2019", topic: "Violence as Power" },
        { event: "Soleimani Assassination", date: "Jan 2020", topic: "Violence as Power" },
        { event: "Jan 6th Capitol Riot", date: "Jan 2021", topic: "Violence as Power" },
        { event: "Myanmar Military Coup", date: "Feb 2021", topic: "Violence as Power" },
        { event: "Invasion of Ukraine", date: "Feb 2022", topic: "Violence as Power" },
        { event: "Sudan Civil War", date: "Apr 2023", topic: "Violence as Power" },
        { event: "Iran Attacks Israel", date: "Apr 2024", topic: "Violence as Power" },
        { event: "Assassination Attempt: Trump", date: "July 2024", topic: "Violence as Power" },
    ];

    let currentEvent = null;

    // --- LOGIC ---
    function spinReels() {
        const spinBtn = document.getElementById('spin-btn');
        const acceptBtn = document.getElementById('accept-btn');
        const reelTopic = document.getElementById('reel-topic');
        const reelEvent = document.getElementById('reel-event');
        const lockSelect = document.getElementById('topic-lock');
        
        spinBtn.disabled = true;
        acceptBtn.disabled = true;
        reelTopic.classList.add('spinning-text');
        reelEvent.classList.add('spinning-text');
        
        playSpinSound();

        // Topic Logic
        let finalTopic = lockSelect.value;
        if (!finalTopic) {
            const uniqueTopics = [...new Set(landmarks.map(l => l.topic))];
            finalTopic = uniqueTopics[Math.floor(Math.random() * uniqueTopics.length)];
        }

        // Event Logic
        const possibleEvents = landmarks.filter(l => l.topic === finalTopic);
        const finalEventObj = possibleEvents[Math.floor(Math.random() * possibleEvents.length)];
        currentEvent = finalEventObj;

        // Visual Loop
        let counter = 0;
        const interval = setInterval(() => {
            reelTopic.innerText = landmarks[Math.floor(Math.random() * landmarks.length)].topic;
            reelEvent.innerText = landmarks[Math.floor(Math.random() * landmarks.length)].event;
            counter++;
            if (counter > 15) {
                clearInterval(interval);
                reelTopic.classList.remove('spinning-text');
                reelEvent.classList.remove('spinning-text');
                
                reelTopic.innerText = finalTopic;
                reelEvent.innerText = finalEventObj.event;
                
                spinBtn.disabled = false;
                acceptBtn.disabled = false;
                playWinSound();
            }
        }, 80);
    }

    function goToPhase2() {
        if (!currentEvent) return;
        document.getElementById('phase-1').classList.add('hidden');
        document.getElementById('phase-2').classList.remove('hidden');
        
        document.getElementById('display-event-name').innerText = currentEvent.event;
        document.getElementById('display-topic-name').innerText = currentEvent.topic;
        window.scrollTo(0,0);
    }

    function goToPhase3() {
        const name = document.getElementById('student-name-input').value;
        const lType = document.getElementById('landmarkType').value;
        const aType = document.getElementById('aspectType').value;
        const q = document.getElementById('aspect-question').value;

        if (!name || !lType || !aType || q.length < 5) {
            alert("üõë Hold up! You need to fill out all fields before proceeding.");
            return;
        }

        document.getElementById('phase-2').classList.add('hidden');
        document.getElementById('phase-3').classList.remove('hidden');
        window.scrollTo(0,0);
    }

    function backToPhase2() {
        document.getElementById('phase-3').classList.add('hidden');
        document.getElementById('phase-2').classList.remove('hidden');
    }

    function generatePassport() {
        // Check for content
        const s1 = document.getElementById('sent-1').value;
        const s3 = document.getElementById('sent-3').value;
        
        if (s1.length < 5 || s3.length < 5) {
            alert("üõë You can't propose an event without explaining it! Fill in the boxes.");
            return;
        }

        // Fill Data
        const now = new Date();
        document.getElementById('current-date').innerText = now.toLocaleDateString();
        document.getElementById('pp-name').innerText = document.getElementById('student-name-input').value;
        document.getElementById('pp-topic').innerText = currentEvent.topic;
        document.getElementById('pp-event').innerText = currentEvent.event;
        document.getElementById('pp-date').innerText = currentEvent.date;
        document.getElementById('pp-aspect').innerText = document.getElementById('aspect-question').value;
        document.getElementById('pp-type').innerText = document.getElementById('landmarkType').value;
        document.getElementById('pp-path').innerText = document.getElementById('aspectType').value;

        // Build Paragraph
        const paragraph = [
            document.getElementById('sent-1').value,
            document.getElementById('sent-2').value,
            document.getElementById('sent-3').value,
            document.getElementById('sent-4').value,
            document.getElementById('sent-5').value
        ].join(' ');
        
        document.getElementById('pp-paragraph').innerText = paragraph;

        // Build Links
        const container = document.getElementById('link-container');
        container.innerHTML = '';
        const q = encodeURIComponent(`${currentEvent.event} significance`);
        
        const sources = [
            { t: "Google Scholar", u: `https://scholar.google.com/scholar?q=${q}` },
            { t: "Pew Research", u: `https://www.google.com/search?q=${q}+site:pewresearch.org` },
            { t: "Britannica", u: `https://www.britannica.com/search?query=${encodeURIComponent(currentEvent.event)}` },
            { t: "The Conversation", u: `https://www.google.com/search?q=${q}+site:theconversation.com` }
        ];

        sources.forEach(s => {
            const a = document.createElement('a');
            a.href = s.u;
            a.target = "_blank";
            a.className = "search-chip";
            a.innerText = "üîé " + s.t;
            container.appendChild(a);
        });

        document.getElementById('phase-3').classList.add('hidden');
        document.getElementById('phase-4').classList.remove('hidden');
        window.scrollTo(0,0);
    }

    function resetTool() {
        location.reload(); // Cleanest way to reset everything
    }
</script>

</body>
</html>
